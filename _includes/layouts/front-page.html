{% extends "layouts/base.html" %}
{% block content %}
    <div class="l-front-page">
        {% include "partials/post-heading.html" %}

        {% if preview %}
            <div class="group">
                <h2>Preview</h2>
                <div class="screenshot-preview">
                    <div class="slideshow-container">
                        {{ preview | safe }}
                    </div>
                    <div class="navigation-buttons">
                        <button id="prev-btn" class="btn btn--primary btn--primary-shadow"><</button>
                        <button id="next-btn" class="btn btn--primary btn--primary-shadow">></button>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if overview %}
            <div class="group">
                <h2>Overview</h2>
                <div class="l-card">
                    {% for post in overview %}
                        <div class="post-card">
                            <span class="post-card__serial-number"></span>
                            <h2 class="post-card__title">{{ post.title }}</h2>
                            <p>{{ post.description }}</p>
                            <a class="btn btn--primary btn--primary-shadow" href="{{ post.url }}">
                                Read More
                                <span class="sr-only">{{ post.title }}</span>
                            </a>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}

        {% if faqs %}
            <div class="group">
                <h2>Frequently Asked Questions</h2>
                <div class="accordion-list">
                    {% for faq in faqs %}
                        <div class="accordion-card">
                            <h3 class="accordion-card__title">{{ faq.title }}</h3>
                            <div class="accordion-card__content">
                                {% markdownRender faq.description %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const slides = document.querySelectorAll('.slideshow-container img');
            const nextButton = document.getElementById('next-btn');
            const prevButton = document.getElementById('prev-btn');
            const modal = document.createElement('div');
            const modalImg = document.createElement('img');
            modal.appendChild(modalImg);
            document.body.appendChild(modal);

            modal.style.display = 'none';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100%';
            modal.style.height = '100%';
            modal.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
            modal.style.justifyContent = 'center';
            modal.style.alignItems = 'center';
            modal.style.zIndex = '9999';

            modalImg.style.maxWidth = '90%';
            modalImg.style.maxHeight = '90%';
            modalImg.style.margin = 'auto';

            let currentSlide = 0;
            const numImagesToShow = 2;  // Show 2 images at a time

            function showSlides(index) {
                const totalImages = slides.length;
                // Hide all images first
                slides.forEach(slide => slide.style.display = 'none');

                // Show the current pair of images
                for (let i = 0; i < numImagesToShow; i++) {
                    const slideIndex = (index + i) % totalImages;
                    slides[slideIndex].style.display = 'block';
                }
            }

            // Initialize the first slide
            showSlides(currentSlide);

            // Navigate to the next slide
            nextButton.addEventListener('click', function () {
                currentSlide = (currentSlide + numImagesToShow) % slides.length;
                showSlides(currentSlide);
            });

            // Navigate to the previous slide
            prevButton.addEventListener('click', function () {
                currentSlide = (currentSlide - numImagesToShow + slides.length) % slides.length;
                showSlides(currentSlide);
            });

            // Add click event to images to open them in modal
            slides.forEach((slide) => {
                slide.addEventListener('click', function () {
                    modal.style.display = 'flex';
                    modalImg.src = slide.src;
                });
            });

            // Close the modal when clicked anywhere outside the image
            modal.addEventListener('click', function () {
                modal.style.display = 'none';
            });
        });
    </script>

    <style>
        .slideshow-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
            display: flex;
            justify-content: space-between;
        }

        .slideshow-container img {
            display: none;
            width: 48%; /* Show 2 images per row */
            height: auto;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            cursor: pointer;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .navigation-buttons button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
{% endblock %}
